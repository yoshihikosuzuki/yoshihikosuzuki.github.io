---
layout: post
title: GitHub Pages の画像を Typora でどう扱うか
---

まず大きな選択肢としては、

1. 画像をローカルに置いて相対パス指定
2. 画像をインターネット上に置いて URL 指定

の2つがある。



## 1. ローカルに置く

ある画像ファイルがあって、それを Typora で編集している Markdown ファイルにドラッグ&ドロップした際の Typora の挙動のオプションは以下のどれか一つ。

* 元のファイルパスをリンクとして埋め込む
* 元のファイルを以下のいずれかのディレクトリにコピーして、コピーした先のファイルパスをリンクとして埋め込む
  1. 現在開いている Markdown ファイルのあるディレクトリ`./``
  2. `./assets/`
  3. `./${filename}.assets/`
  4. 任意の指定したディレクトリ

* iPic にアップロード

このうち、まず最初と最後を選択肢から除外する。元のファイルパスをそのまま使うのが嫌なのは当然として、iPic を避ける理由は以下の通り。

* 画質が下がる
* iPic のサーバがダウンして画像にアクセスできなくなることがある



となると画像をローカルのどこかにコピーする戦略を取ることになるが、ここで、Typora が認識する相対ファイルパスと Jekyll が生成したウェブサイト側が認識する相対ファイルパスが異なることが問題となる。

* Typora: 現在開いている Markdown ファイルからの相対パス
* Jekyll: Markdown を変換して生成された HTML ファイルからの相対パス(、もしくは`_site/`をルートとする絶対パス)

そのため、Typora 側でも Jekyll 側でも一致するような相対ファイルパスが必要、、なのだが、おそらくそのようなものは存在しない。なぜなら、Jekyll は`_posts/`以下の Markdown ファイル群から HTML を生成する際に年 -> 月による階層的なディレクトリ構造を作ってしまい、そうなると実質的に相対パスが使えなくなってしまう。Typora にとっては Jekyll のルートディレクトリなど知ったことではないので、絶対パスを使うこともできない。



結局、画像をローカルに置いて管理するのは得策ではなさそうということが分かった。



## 2. インターネット上に置く

こちらの場合は手順は簡単で、大まかに言うと挿入したい各々の画像について下の二つを行えばよい。

1. 好きなファイル共有サービスや画像アップロードサービスに画像をアップロードして、共有 URL を取得する
2. Markdown 中で`<img src="取得したURL">`と記述する

ただし、Google Drive の場合は「共有可能なリンクを取得」でコピーされる URL そのままではダメで、

```ini
https://drive.google.com/open?id=[ユニークID]
```

を、

```ini
https://drive.google.com/uc?id=[ユニークID]
```

のように変えてやる必要がある。